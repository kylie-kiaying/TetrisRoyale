import axios from 'axios';

export const fetchTournaments = async () => {
  try {
    const response = await axios.get('http://localhost:8003/tournaments'); // Adjust endpoint as necessary
    return response.data;
  } catch (error) {
    console.error('Error fetching tournaments:', error);
    return [];
  }
};

export const filterByRating = (tournaments, userRating, ratingRange = 100) => {
  return tournaments.filter(
    (tournament) =>
      Math.abs(tournament.recommendedRating - userRating) <= ratingRange
  );
};

export const filterEnrolledTournaments = (tournaments, username) => {
  return tournaments.filter(
    (tournament) => !tournament.registrants.includes(username)
  );
};

export const getRecommendedTournaments = async (
  userRating,
  username,
  ratingRange = 100
) => {
  const allTournaments = await fetchTournaments();
  const filteredByRating = filterByRating(
    allTournaments,
    userRating,
    ratingRange
  );
  return filterEnrolledTournaments(filteredByRating, username);
};
